[root@ip-172-31-16-88 ec2-user]# cat ec2.tf
provider "aws" {
  region = "us-east-2"
  access_key = "AKIA5FJWAHZSBJBDVHW2"
  secret_key = "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"
}

resource "aws_db_instance" "postgresql" {
  allocated_storage    = 20
  storage_type         = "gp2"
  engine               = "postgres"
  engine_version       = "9.5"
  instance_class       = "db.t2.micro"
  name                 = "mydb"
  username             = "postgres"
  password             = "password"
  final_snapshot_identifier = "terraform-aws-postgresql-rds-snapshot"
  skip_final_snapshot  = false
}

resource "aws_instance" "api" {
  ami           = "ami-013de1b045799b282"
  instance_type = "t2.micro"
  key_name = "mynewkey"
  depends_on = [aws_db_instance.postgresql]
  user_data=<<EOF
         #!/bin/bash
         sudo apt-get update -y
         sufdo apt-get install nodejs -y
         sudo apt-get install npm -y
         sudo npm start
  EOF
  tags = {
    Name = "apiserver_new"
  }
}

resource "aws_instance" "web" {
  ami           = "ami-013de1b045799b282"
  instance_type = "t2.micro"
  key_name = "mynewkey"
  depends_on = [aws_instance.api]
  user_data=<<EOF
         #!/bin/bash
         sudo apt-get update -y
         sudo apt-get install nodejs -y
         sudo apt-get install npm -y
         sudo npm start
  EOF
  tags = {
    Name = "webserver_new"
  }
}

